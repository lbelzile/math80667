<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Effect sizes and power | Experimental Design and Statistical Methods</title>
<meta name="author" content="Léo Belzile">
<meta name="description" content="In social studies, it is common to write a paper containing multiple studies on a similar topic. These may use different designs, with varying sample size. If the studies uses different...">
<meta name="generator" content="bookdown 0.30 with bs4_book()">
<meta property="og:title" content="7 Effect sizes and power | Experimental Design and Statistical Methods">
<meta property="og:type" content="book">
<meta property="og:description" content="In social studies, it is common to write a paper containing multiple studies on a similar topic. These may use different designs, with varying sample size. If the studies uses different...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Effect sizes and power | Experimental Design and Statistical Methods">
<meta name="twitter:description" content="In social studies, it is common to write a paper containing multiple studies on a similar topic. These may use different designs, with varying sample size. If the studies uses different...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Experimental Design and Statistical Methods</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Experimental Design and Statistical Methods</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">2</span> Hypothesis testing</a></li>
<li><a class="" href="CRT.html"><span class="header-section-number">3</span> Completely randomized designs</a></li>
<li><a class="" href="contrasts-multiple-testing.html"><span class="header-section-number">4</span> Contrasts and multiple testing</a></li>
<li><a class="" href="complete-factorial-designs.html"><span class="header-section-number">5</span> Complete factorial designs</a></li>
<li><a class="" href="designs-to-reduce-the-error.html"><span class="header-section-number">6</span> Designs to reduce the error</a></li>
<li><a class="active" href="effect-sizes-and-power.html"><span class="header-section-number">7</span> Effect sizes and power</a></li>
<li><a class="" href="replication-crisis.html"><span class="header-section-number">8</span> Replication crisis</a></li>
<li><a class="" href="repeated-measures-and-multivariate-models.html"><span class="header-section-number">9</span> Repeated measures and multivariate models</a></li>
<li><a class="" href="introduction-to-mixed-models.html"><span class="header-section-number">10</span> Introduction to mixed models</a></li>
<li><a class="" href="causal-inference.html"><span class="header-section-number">11</span> Causal inference</a></li>
<li><a class="" href="nonparametric-tests.html"><span class="header-section-number">12</span> Nonparametric tests</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/lbelzile/math80667a">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="effect-sizes-and-power" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Effect sizes and power<a class="anchor" aria-label="anchor" href="#effect-sizes-and-power"><i class="fas fa-link"></i></a>
</h1>
<p>In social studies, it is common to write a paper containing multiple studies on a similar topic. These may use different designs, with varying sample size. If the studies uses different questionnaires, or change the Likert scale, the results and the mean difference between groups are not directly comparable between experiments.</p>
<p>Another related task is replication of study, whereby researchers use the same material and setting and re-run an experiment with different data. For the replication to be somewhat successful (or at least reliable), one needs to determine beforehand how many participants should be recruited in the study. In order to do so, one needs to have a measure of effect size and set the desired power.</p>
<p>We could think for an example of comparing statistics or <span class="math inline">\(p\)</span>-values, which are by construction standardized unitless measures, making them comparable across study.
Test statistics show how outlying observed differences between experimental conditions relative to a null hypothesis, typically that of no effect (equal mean in each subgroup). However, statistics are usually a function of both the sample size (the number of observations in each experimental condition) and the effect size (how large the standardized differences between groups are), making them unsuitable for describing differences.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-effectsize"></span>
<img src="07-power_effect_files/figure-html/fig-effectsize-1.png" alt="True sampling distribution for a two-sample $t$-test under the alternative (rightmost curve) and null distribution (leftmost curve) with small  (left panel) and large (right panel) sample sizes." width="90%"><p class="caption">
Figure 7.1: True sampling distribution for a two-sample <span class="math inline">\(t\)</span>-test under the alternative (rightmost curve) and null distribution (leftmost curve) with small (left panel) and large (right panel) sample sizes.
</p>
</div>
<p>Figure <a href="effect-sizes-and-power.html#fig:fig-effectsize">7.1</a> shows an example with the sampling distributions of the difference in mean under the null (curve centered at zero) and the true alternative (mean difference of two). The area in white under the curve represents the power, which is larger with larger sample size and coincides with smaller average <span class="math inline">\(p\)</span>-values for the testing procedure.</p>
<p>One could argue that, on the surface, every null hypothesis is wrong and that, with a sufficiently large number of observation, all observed differences eventually become “statistically significant”. This has to do with the fact that we become more and more certain of the estimated means of each experimental sub-condition. Statistical significance of a testing procedure does not translate into practical relevance, which itself depends on the scientific question at hand.
For example, consider the development of a new drug for commercialization by Health Canada: what is the minimum difference between two treatments that would be large enough to justify commercialization of the new drug? If the effect is small but it leads to many lives saved, would it still be relevant? Such decision involve a trade-off between efficacy of new treatment relative to the status quo, the cost of the drug, the magnitude of the improvement, etc.</p>
<p>Effect size are summaries to inform about the standardized magnitude of these differences; they are used to combine results of multiple experiments using meta-analysis, or to calculate sample size requirements to replicate an effect in power studies.</p>
<div id="effect-sizes" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Effect sizes<a class="anchor" aria-label="anchor" href="#effect-sizes"><i class="fas fa-link"></i></a>
</h2>
<p>There are two main classes of effect size: standardized mean differences and ratio (percentages) of explained variance. The latter are used in analysis of variance when there are multiple groups to compare.</p>
<p>Unfortunately, the literature on effect size is quite large. Researchers often fail to distinguish between estimand (unknown target) and the estimator that is being used, with frequent notational confusion arising due to conflicting standards and definitions. Terms are also overloaded: the same notation may be used to denote an effect size, but it will be calculated differently depending on whether the design is between-subject or within-subject (with repeated correlated measures per participant), or whether there are blocking factors.</p>
<div id="standardized-mean-differences" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Standardized mean differences<a class="anchor" aria-label="anchor" href="#standardized-mean-differences"><i class="fas fa-link"></i></a>
</h3>
<p>To gather intuition, we begin with the task of comparing the means of two groups using a two-sample <span class="math inline">\(t\)</span>-test, with the null hypothesis of equality in means or <span class="math inline">\(\mathscr{H}_0: \mu_1 = \mu_2\)</span>. The test statistic is
<span class="math display">\[\begin{align*}
T =  \frac{\widehat{\mu}_2 - \widehat{\mu}_1}{\widehat{\sigma}} \left(\frac{1}{n_1}+\frac{1}{n_2}\right)^{-1/2}
\end{align*}\]</span>
where <span class="math inline">\(\widehat{\sigma}\)</span> is the pooled sample size estimator. The first term, <span class="math inline">\(\widehat{d}_s = (\widehat{\mu}_2 - \widehat{\mu}_1)/\widehat{\sigma}\)</span>, is termed Cohen’s <span class="math inline">\(d\)</span> <span class="citation">(<a href="references.html#ref-Cohen:1988" role="doc-biblioref">Cohen 1988</a>)</span> and it measures the standardized difference between groups, a form of signal-to-noise ratio. As the sample size gets larger and larger, the sample mean and pooled sample variance become closer and closer to the true population values <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span> and <span class="math inline">\(\sigma\)</span>; at the same time, the statistic <span class="math inline">\(T\)</span> becomes bigger as <span class="math inline">\(n\)</span> becomes larger because of the second term.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;If we consider a balanced sample, &lt;span class="math inline"&gt;\(n_1 = n_2 = n/2\)&lt;/span&gt; we can rewrite the statistic as &lt;span class="math inline"&gt;\(T = \sqrt{n} \widehat{d}_s/2\)&lt;/span&gt; and the statement that &lt;span class="math inline"&gt;\(T\)&lt;/span&gt; increases with &lt;span class="math inline"&gt;\(n\)&lt;/span&gt; on average becomes more obvious.&lt;/p&gt;'><sup>42</sup></a></p>
<p>The difference <span class="math inline">\(d=(\mu_1-\mu_2)/\sigma\)</span> has an obvious interpretation: a distance of <span class="math inline">\(a\)</span> indicates that the means of the two groups are <span class="math inline">\(a\)</span> standard deviation apart. Cohen’s <span class="math inline">\(d\)</span> is sometimes loosely categorized in terms of weak (<span class="math inline">\(d = 0.2\)</span>), medium (<span class="math inline">\(d=0.5\)</span>) and large (<span class="math inline">\(d=0.8\)</span>) effect size; these, much like arbitrary <span class="math inline">\(p\)</span>-value cutoffs, are rules of thumbs. Alongside <span class="math inline">\(d\)</span>, there are many commonly reported metrics that are simple transformations of <span class="math inline">\(d\)</span> describing the observed difference. This interactive <a href="https://rpsychologist.com/cohend/">applet</a> by Kristoffer Magnusson <span class="citation">(<a href="references.html#ref-magnussonCohend" role="doc-biblioref">Magnusson 2021</a>)</span> shows the visual impact of changing the value of <span class="math inline">\(d\)</span> along.
There are different estimators of <span class="math inline">\(d\)</span> depending on whether or not the pooled variance estimator is used. Cohen’s <span class="math inline">\(d\)</span>, is upward biased, meaning it gives values that are on average larger than the truth. Hedge’s <span class="math inline">\(g\)</span> <span class="citation">(<a href="references.html#ref-Hedges:1981" role="doc-biblioref">Hedges 1981</a>)</span> offers a bias-correction and should always be preferred as an estimator.</p>
<p>For these different estimators, it is possible to obtain (asymmetric) confidence intervals or tolerance intervals.[By using the pivot method <span class="citation">(<a href="references.html#ref-Steiger:2004" role="doc-biblioref">Steiger 2004</a>)</span> and relating the effect size to the noncentrality parameter of the null distribution, whether <span class="math inline">\(\mathsf{St}\)</span>, <span class="math inline">\(\mathsf{F}\)</span> or <span class="math inline">\(\chi^2\)</span>.]</p>
<div class="example">
<p><span id="exm:LiuRimMinMin2022E1effect" class="example"><strong>Example 7.1  (The Surprise of Reaching Out) </strong></span>We consider a two-sample <span class="math inline">\(t\)</span>-test for the study of <span class="citation">Liu et al. (<a href="references.html#ref-Liu.Rim.Min.Min:2022" role="doc-biblioref">2022+</a>)</span> discussed in Example <a href="hypothesis-testing.html#exm:LiuRimMinMin2022E1">2.5</a>. The difference in average response index is 0.371, indicating that the responder have a higher score. The <span class="math inline">\(p\)</span>-value is 0.041, showing a small effect.</p>
<p>If we consider the standardized difference <span class="math inline">\(d\)</span>, the group means are -0.289 standard deviations apart based on Hedge’s <span class="math inline">\(g\)</span>, with an associated 95% confidence interval of [-0.567, -0.011]: thus, the difference found is small (using <span class="citation">Cohen (<a href="references.html#ref-Cohen:1988" role="doc-biblioref">1988</a>)</span>’s convention) and there is a large uncertainty surrounding it.</p>
<p>There is a 42% probability that an observation drawn at random from the responder condition will exceed the mean of the initiator group (probability of superiority) and 41.9% of the responder observations will exceed the mean of the initiator.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">LRMM22_S1</span>, package <span class="op">=</span> <span class="st">"hecedsm"</span><span class="op">)</span></span>
<span><span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span></span>
<span>  <span class="va">appreciation</span> <span class="op">~</span> <span class="va">role</span>, </span>
<span>  data <span class="op">=</span> <span class="va">LRMM22_S1</span>,</span>
<span>  var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">effect</span> <span class="op">&lt;-</span> <span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">hedges_g</a></span><span class="op">(</span></span>
<span>  <span class="va">appreciation</span> <span class="op">~</span> <span class="va">role</span>, </span>
<span>  data <span class="op">=</span> <span class="va">LRMM22_S1</span>, </span>
<span>  pooled_sd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/diff_to_cles.html">d_to_cles</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="ratio-and-proportion-of-variance" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Ratio and proportion of variance<a class="anchor" aria-label="anchor" href="#ratio-and-proportion-of-variance"><i class="fas fa-link"></i></a>
</h3>
<p>Another class of effect sizes are obtained by considering either the ratio of the variance due to an effect (say differences in means relative to the overall mean) relative to the background level of noise as measured by the variance.</p>
<p>One common measure employed in software is Cohen’s <em>f</em> <span class="citation">(<a href="references.html#ref-Cohen:1988" role="doc-biblioref">Cohen 1988</a>)</span>, which for a one-way ANOVA (equal variance <span class="math inline">\(\sigma^2\)</span>) with more than two groups,
<span class="math display">\[
f^2 = \frac{1}{\sigma^2} \sum_{j=1}^k \frac{n_j}{n}(\mu_j - \mu)^2 = \frac{\sigma^2_{\text{effect}}}{\sigma^2},
\]</span>
a weighted sum of squared difference relative to the overall mean <span class="math inline">\(\mu\)</span>. <span class="math inline">\(\sigma^2_{\text{effect}}\)</span> is a measure of the variability that is due to the difference in mean, so standardizing it by the measurement variance gives us a ratio of variance with values higher than one indicating that more variability is explainable, leading to higher effect sizes. If the means of every subgroup is the same, then <span class="math inline">\(f=0\)</span>. For <span class="math inline">\(k=2\)</span> groups, Cohen’s <span class="math inline">\(f\)</span> and Cohen’s <span class="math inline">\(d\)</span> are related via <span class="math inline">\(f=d/2\)</span>.</p>
<p>Cohen’s <span class="math inline">\(f\)</span> can be directly related to the behaviour of the <span class="math inline">\(F\)</span> statistic under an alternative, as explained in Section <a href="effect-sizes-and-power.html#power-oneway">7.2.1</a>. However, since the interpretation isn’t straightforward, we typically consider proportions of variance (rather than ratios of variance).</p>
<p>To build such an effect size, we break down the variability that is explained by our experimental manipulation (<span class="math inline">\(\sigma^2_\text{effect}\)</span>), here denoted by effect, from the leftover unexplained part, or residual (<span class="math inline">\(\sigma^2_\text{resid}\)</span>). In a one-way analysis of variance, <span class="math display">\[\sigma^2_{\text{total}} = \sigma^2_{\text{resid}} + \sigma^2_{\text{effect}}\]</span> and the percentage of variability explained by the <span class="math inline">\(\text{effect}\)</span>.
<span class="math display">\[\eta^2 = \frac{\text{explained variability}}{\text{total variability}}= \frac{\sigma^2_{\text{effect}}}{\sigma^2_{\text{resid}} + \sigma^2_{\text{effect}}} = \frac{\sigma^2_{\text{effect}}}{\sigma^2_{\text{total}}}.\]</span>
Simple arithmetic manipulations reveal that <span class="math inline">\(f^2 = \eta^2/(1-\eta^2)\)</span>, so we can relate any proportion of variance in terms of ratio and vice-versa.</p>
<p>Such an effect size depends on unknown population quantities (the true means of each subgroup, the overall mean and the variance). There are multiple alternative estimators to estimate <span class="math inline">\(\eta^2\)</span>, and researchers are often carefree when reporting as to which is used. To disambiguate, I will put <span class="math inline">\(\hat{\eta}^2\)</span> to denote an estimator. To make an analogy, there are many different recipes (estimators) that can lead to a particular cake, but some may lead to a mixing that is on average too wet if they are not well calibrated.</p>
<p>The default estimator for <span class="math inline">\(\eta^2\)</span> is the coefficient of determination of the linear regression, denoted <span class="math inline">\(\widehat{R}^2\)</span> or <span class="math inline">\(\widehat{\eta}^2\)</span>. The latter can be reconstructed from the analysis of variance table using the formula
<span class="math display">\[
\widehat{R}{}^2 = \frac{F\nu_1}{F\nu_1 + \nu_2}
\]</span>
where for the one-way ANOVA <span class="math inline">\(\nu_1 = K-1\)</span> and <span class="math inline">\(\nu_2 = n-K\)</span> are the degrees of freedom of a design with <span class="math inline">\(n\)</span> observations and <span class="math inline">\(K\)</span> experimental conditions.</p>
<p>Unfortunately, <span class="math inline">\(\widehat{R}{}^2\)</span> is an upward biased estimator (too large on average), leading to optimistic measures. Another estimator of <span class="math inline">\(\eta^2\)</span> that is recommended in <span class="citation">Keppel and Wickens (<a href="references.html#ref-Keppel/Wickens:2004" role="doc-biblioref">2004</a>)</span> for power calculations is <span class="math inline">\(\widehat{\omega}^2\)</span>, which is
<span class="math display">\[\widehat{\omega}^2 = \frac{\nu_1 (F-1)}{\nu_1(F-1)+n}.\]</span>
Since the <span class="math inline">\(F\)</span> statistic is approximately 1 on average, this measure removes the mode. Both <span class="math inline">\(\widehat{\omega}^2\)</span> and <span class="math inline">\(\widehat{\epsilon}^2\)</span> have been reported to be less biased and thus preferable as estimators of the true proportion of variance <span class="citation">(<a href="references.html#ref-Lakens:2013" role="doc-biblioref">Lakens 2013</a>)</span>.</p>
</div>
<div id="partial-effects-and-variance-decomposition" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Partial effects and variance decomposition<a class="anchor" aria-label="anchor" href="#partial-effects-and-variance-decomposition"><i class="fas fa-link"></i></a>
</h3>
<p>In a multiway design with several factors, we may want to estimate the effect of separate factors or interactions. In such cases, we can break down the variability explained by manipulations per effect. The effect size for such models are build by comparing the variance explained by the effect <span class="math inline">\(\sigma^2_{\text{effect}}\)</span>.</p>
<p>For example, say we have a completely randomized balanced design with two factors <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> and their interaction <span class="math inline">\(AB\)</span>. We can decompose the total variance as
<span class="math display">\[\sigma^2_{\text{total}} = \sigma^2_A + \sigma^2_B + \sigma^2_{AB} + \sigma^2_{\text{resid}}.\]</span>
When the design is balanced, these variance terms can be estimated using the mean squared error from the analysis of variance table output. If the design is unbalanced, the sum of square decomposition is not unique and we will get different estimates when using Type II and Type III sum of squares.</p>
<p>We can get formula similar to the one-sample case with now what are termed <strong>partial</strong> effect sizes, e.g.,
<span class="math display">\[\widehat{\omega}^2_{\langle \text{effect} \rangle} = \frac{\text{df}_{\text{effect}}(F_{\text{effect}}-1)}{\text{df}_{\text{effect}}(F_{\text{effect}}-1) + n},\]</span>
where <span class="math inline">\(n\)</span> is the overall sample size and <span class="math inline">\(F_\text{effect}\)</span> and the corresponding degrees of freedom could be the statistic associated to the main effects <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, or the interaction term <span class="math inline">\(AB\)</span>. In <strong>R</strong>, the <code>effectsize</code> package reports these estimates with one-sided confidence intervals derived using the pivot method <span class="citation">(<a href="references.html#ref-Steiger:2004" role="doc-biblioref">Steiger 2004</a>)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;The confidence intervals are based on the &lt;span class="math inline"&gt;\(\mathsf{F}\)&lt;/span&gt; distribution, by changing the non-centrality parameter and inverting the distribution function (pivot method). This yields asymmetric intervals.&lt;/p&gt;'><sup>43</sup></a></p>
<p>Software will typically return estimates of effect size alongside with the designs, but there are small things to keep in mind. One is that the decomposition of the variance is not unique with unbalanced data. The second is that, when using repeated measures and mixed models, the same notation is used to denote different quantities.</p>
<p>Lastly, it is customary to report effect sizes that include the variability of blocking factors and random effects, leading to so-called <strong>generalized</strong> effect sizes. Include the variance of all blocking factors and interactions (only with the effect!) in the denominator.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Typically, there won’t be any interaction with blocking factors, but it there was for some reason, it should be included in the total.&lt;/p&gt;"><sup>44</sup></a></p>
<p>For example, if <span class="math inline">\(A\)</span> is the experimental factor whose main effect is of interest, <span class="math inline">\(B\)</span> is a blocking factor and <span class="math inline">\(C\)</span> is another experimental factor, use
<span class="math display">\[\eta_{\langle A \rangle}^2 = \frac{\sigma^2_A}{\sigma^2_A + \sigma^2_B + \sigma^2_{AB} + \sigma^2_{\text{resid}}}.\]</span>
as generalized partial effect. In <strong>R</strong>, most effect sizes for variance proportion have a <code>generalized</code> argument to which the vector of names of blocking factor can be passed. The reason for including blocking factors and random effects is that they would not necessarily be available in a replication.
The correct effect size measure to calculate and to report depends on the design, and there are numerous estimators that can be utilized. Since they are related to one another, it is oftentimes possible to compute them directly from the output or convert. The formula highlight the importance of reporting (with enough precision) exactly the values of the test statistic.</p>
</div>
</div>
<div id="power-1" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Power<a class="anchor" aria-label="anchor" href="#power-1"><i class="fas fa-link"></i></a>
</h2>
<p>The power is the probability of correctly rejecting a null hypothesis when it isn’t true. However, whereas the null alternative corresponds to a single value (equality in mean), there are infinitely many alternatives…</p>
<p>There is an intricate relation between effect size, power and sample size. Journals and grant agencies oftentimes require an estimate of the latter before funding a study, so one needs to ensure that the sample size is large enough to pick-up effects of scientific interest (good signal-to-noise), but also not overly large as to minimize time and money and make an efficient allocation of resources. This is Goldilock’s principle, but having more never hurts.</p>
<p>If we run a pilot study to estimate the background level of noise and the estimated effect, or if we wish to perform a replication study, we will come up with a similar question in both cases: how many participants are needed to reliably detect such a difference? Setting a minimum value for the power (at least 80%, but typically 90% or 95% when feasible) ensures that the study is more reliable and ensures a high chance of success of finding an effect of at least the size specified. A power of 80% ensures that, on average, 4 in 5 experiments in which we study a phenomenon with the specified non-null effect size should lead to rejecting the null hypothesis.</p>
<p>In order to better understand the interplay between power, effect size and sample size, we consider a theoretical example. The purpose of displaying the formula is to (hopefully) more transparently confirm some of our intuitions about what leads to higher power. There are many things that can influence the power:</p>
<ul>
<li>the experimental design: a blocking design or repeated measures tend to filter out some of the unwanted variability in the population, thus increasing power relative to a completely randomized design</li>
<li>the background variability <span class="math inline">\(\sigma\)</span>:the noise level is oftentimes intrinsic to the measurement. It depends on the phenomenon under study, but instrumentation and the choice of scale, etc. can have an impact. Running experiments in a controlled environment helps reduce this, but researchers typically have limited control on the variability inherent to each observation.</li>
<li>the sample size: as more data are gathered, information accumulates. The precision of measurements (e.g., differences in mean) is normally determined by the group with the smallest sample size, so (approximate) balancing increases power if the variance in each group is the same.</li>
<li>the size of the effect: the bigger the effect, the easier it is to accurately detect (it’s easier to spot an elephant than a mouse hiding in a classroom).</li>
<li>the level of the test, <span class="math inline">\(\alpha\)</span>: if we increase the rejection region, we technically increase power when we run an experiment under an alternative regime. However, the level is oftentimes prespecified to avoid type I errors.
We may consider multiplicity correction within the power function, such as Bonferonni’s method, which is equivalent to reducing <span class="math inline">\(\alpha\)</span>.</li>
</ul>
<div id="power-oneway" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Power for one-way ANOVA<a class="anchor" aria-label="anchor" href="#power-oneway"><i class="fas fa-link"></i></a>
</h3>
<p>To fix ideas, we consider the one-way analysis of variance model. In the usual setup, we consider <span class="math inline">\(K\)</span> experimental conditions with <span class="math inline">\(n_k\)</span> observations in group <span class="math inline">\(k\)</span>, whose population average we denote by <span class="math inline">\(\mu_k\)</span>. We can parametrize the model in terms of the overall sample average,
<span class="math display">\[\begin{align*}
\mu = \frac{1}{n}\sum_{j=1}^K\sum_{i=1}^{n_j} \mu_j = \frac{1}{n}\sum_{j=1}^K n_j \mu_j,
\end{align*}\]</span>
where <span class="math inline">\(n=n_1 + \cdots +n_K\)</span> is the total sample size.
The <span class="math inline">\(F\)</span>-statistic of the one-way ANOVA is
<span class="math display">\[\begin{align*}
F =  \frac{\text{between sum of squares}/(K-1)}{\text{within sum of squares}/(n-K)}
\end{align*}\]</span>
The null distribution is <span class="math inline">\(F(K-1, n-K)\)</span>. Our interest is in understanding how the <em>F</em>-statistic behaves under an alternative.</p>
<p>During the construction, we stressed out that the denominator is an estimator of <span class="math inline">\(\sigma^2\)</span> under both the null and alternative. What happens to the numerator? We can write the population average for
<span class="math display">\[
\mathsf{E}(\text{between sum of squares}) = \sigma^2\{(K-1) + \Delta\}.
\]</span>
where
<span class="math display">\[
\Delta = \dfrac{\sum_{j=1}^K n_j(\mu_j - \mu)^2}{\sigma^2} = nf^2.
\]</span>
with <span class="math inline">\(f^2\)</span> the square of Cohen’s <span class="math inline">\(f\)</span>. Under the null hypothesis, <span class="math inline">\(\mu_j=\mu\)</span> for <span class="math inline">\(j=1, \ldots, K\)</span> and <span class="math inline">\(\Delta=0\)</span>, but if some groups have different average the displacement will be non-zero. The greater <span class="math inline">\(\Delta\)</span>, the further the mode (peak of the distribution) is from unity and the greater the power.</p>
<p>Closer examination reveals that <span class="math inline">\(\Delta\)</span> increases with <span class="math inline">\(n_j\)</span> (sample size) and with the true squared mean difference <span class="math inline">\((\mu_j-\mu)^2\)</span> increases effect size represented by the difference in mean, but decreases as the observation variance increases.</p>
<p>Under the alternative, the distribution of the <span class="math inline">\(F\)</span> statistic is a noncentral Fisher distribution, denoted <span class="math inline">\(\mathsf{F}(\nu_1, \nu_2, \Delta)\)</span> with degrees of freedom <span class="math inline">\(\nu_1\)</span> and <span class="math inline">\(\nu_2\)</span> and noncentrality parameter <span class="math inline">\(\Delta\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Note that the &lt;span class="math inline"&gt;\(F(\nu_1, \nu_2)\)&lt;/span&gt; distribution is indistinguishable from &lt;span class="math inline"&gt;\(\chi^2(\nu_1)\)&lt;/span&gt; for &lt;span class="math inline"&gt;\(\nu_2\)&lt;/span&gt; large. A similar result holds for tests with &lt;span class="math inline"&gt;\(\chi^2\)&lt;/span&gt; null distributions.&lt;/p&gt;'><sup>45</sup></a> To calculate the power of a test, we need to single out a specific alternative hypothesis.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:powercurve"></span>
<img src="07-power_effect_files/figure-html/powercurve-1.png" alt="Density curves for the null distribution (full line) and true distribution (dashed line) under noncentrality parameter $\Delta=3$. The area in white under the curve denotes the power under this alternative." width="80%"><p class="caption">
Figure 7.2: Density curves for the null distribution (full line) and true distribution (dashed line) under noncentrality parameter <span class="math inline">\(\Delta=3\)</span>. The area in white under the curve denotes the power under this alternative.
</p>
</div>
<p>The plot in Figure <a href="effect-sizes-and-power.html#fig:powercurve">7.2</a> shows the null (full line) distribution and the true distribution (dashed line) for a particular alternative. The noncentral <span class="math inline">\(\mathsf{F}\)</span> is shifted to the right and right skewed, so the mode (peak) is further away from 1.</p>
<p>Given a value of <span class="math inline">\(\Delta=nf^2\)</span> and information about the effect of interest (degrees of freedom of the effect and the residuals), we can compute the tail probability as follows</p>
<ol style="list-style-type: decimal">
<li>Compute the cutoff point: the value under <span class="math inline">\(\mathscr{H}_0\)</span> that leads to rejection at level <span class="math inline">\(\alpha\)</span>
</li>
<li>Compute probability below the alternative curve, from the cutoff onwards.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">qf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>, df1 <span class="op">=</span> <span class="va">df1</span>, df2 <span class="op">=</span> <span class="va">df2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">cutoff</span>,  df1 <span class="op">=</span> <span class="va">df1</span>, df2 <span class="op">=</span> <span class="va">df2</span>, </span>
<span>    ncp <span class="op">=</span> <span class="va">Delta</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>In practice, a software will return these quantities and inform us about the power. Note that these results are trustworthy provided the model assumptions are met, otherwise they may be misleading.</p>
<p>The most difficult question when trying to estimate sample size for a study is determining which value to use for the effect size. One could opt for a value reported elsewhere for a similar scale to estimate the variability and provide educated guesses for the mean differences. Another option is to run a pilot study and use the resulting estimates to inform about sensible values, perhaps using confidence intervals to see the range of plausible effect sizes.</p>
<p>Reliance on estimated effect sizes reported in the literature is debatable: many such effects are inflated as a result of the file-drawer problem and, as such, can lead to unreasonably high expectations about power.</p>
<p>The <code>WebPower</code> package in <strong>R</strong> offers a comprehensive solution for conducting power studies, as is the free software <a href="https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower">G*Power</a>.</p>
</div>
<div id="power-in-complex-designs" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Power in complex designs<a class="anchor" aria-label="anchor" href="#power-in-complex-designs"><i class="fas fa-link"></i></a>
</h3>
<p>In cases where an analytic derivations isn’t possible, we can resort to simulations to approximate the power. For a given alternative, we</p>
<ul>
<li>simulate repeatedly samples from the model from the hypothetical alternative world</li>
<li>we compute the test statistic for each of these new samples</li>
<li>we transform these to the associated <em>p</em>-values based on the postulated null hypothesis.</li>
</ul>
<p>At the end, we calculate the proportion of tests that lead to a rejection of the null hypothesis at level <span class="math inline">\(\alpha\)</span>, namely the percentage of <em>p</em>-values smaller than <span class="math inline">\(\alpha\)</span>. We can vary the sample size and see how many observations we need per group to achieve the desired level of power.</p>
<div class="keyidea">
<p><strong>Summary</strong>:</p>
<ul>
<li>Effect sizes are used to provide a standardized measure of the strength of a result, independent of the design and the sample size.</li>
<li>There are two classes: standardized differences and proportions of variance.</li>
<li>Multiple estimators exists: report the latter along with the software used to compute confidence intervals.</li>
<li>The adequate measure of variability to use for the effect size depends on the design: we normally include the variability of blocking factors and residual variance.</li>
<li>Given a design, we can deduce either the sample size, the power or the effect size from the other two metrics. This allows us to compute sample size for a study or replication.</li>
</ul>
</div>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="designs-to-reduce-the-error.html"><span class="header-section-number">6</span> Designs to reduce the error</a></div>
<div class="next"><a href="replication-crisis.html"><span class="header-section-number">8</span> Replication crisis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#effect-sizes-and-power"><span class="header-section-number">7</span> Effect sizes and power</a></li>
<li>
<a class="nav-link" href="#effect-sizes"><span class="header-section-number">7.1</span> Effect sizes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#standardized-mean-differences"><span class="header-section-number">7.1.1</span> Standardized mean differences</a></li>
<li><a class="nav-link" href="#ratio-and-proportion-of-variance"><span class="header-section-number">7.1.2</span> Ratio and proportion of variance</a></li>
<li><a class="nav-link" href="#partial-effects-and-variance-decomposition"><span class="header-section-number">7.1.3</span> Partial effects and variance decomposition</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#power-1"><span class="header-section-number">7.2</span> Power</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#power-oneway"><span class="header-section-number">7.2.1</span> Power for one-way ANOVA</a></li>
<li><a class="nav-link" href="#power-in-complex-designs"><span class="header-section-number">7.2.2</span> Power in complex designs</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/lbelzile/math80667a/blob/master/07-power_effect.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/lbelzile/math80667a/edit/master/07-power_effect.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Experimental Design and Statistical Methods</strong>" was written by Léo Belzile. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
